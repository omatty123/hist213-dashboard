<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Maritime Trade Routes (Minimal)</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/@elfalem/leaflet.curve@0.9.2/dist/leaflet.curve.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            background: #f8fafc;
            overflow: hidden;
        }
        #map {
            height: 100%;
            width: 100%;
        }
        .city-label {
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            color: #0f172a;
            font-family: system-ui, sans-serif;
            font-size: 9px;
            font-weight: 700;
            text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff;
            white-space: nowrap;
        }
        .leaflet-tooltip-left:before,
        .leaflet-tooltip-right:before,
        .leaflet-tooltip-top:before,
        .leaflet-tooltip-bottom:before {
            display: none;
        }
        .leaflet-control-attribution {
            display: none !important;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        const map = L.map("map", {
            zoomControl: false,
            attributionControl: false,
            dragging: false,
            scrollWheelZoom: false,
            doubleClickZoom: false,
            boxZoom: false,
            keyboard: false,
            touchZoom: false
        });

        L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png", {
            subdomains: "abcd",
            maxZoom: 10,
            minZoom: 3
        }).addTo(map);

        const chinese = [
            { eng: "Dengzhou", ll: [37.81, 120.76], pos: 'top' },
            { eng: "Laizhou", ll: [37.18, 119.94], pos: 'bottom' },
            { eng: "Liaodong", ll: [38.80, 121.25], pos: 'left' },
            { eng: "Zhejiang", ll: [29.86, 121.55], pos: 'right' },
            { eng: "Hubei", ll: [30.50, 114.30], pos: 'left', inland: true }
        ];

        const korean = [
            { eng: "Changyŏn", ll: [38.25, 125.10], pos: 'right' },
            { eng: "Sŏnch'ŏn", ll: [39.82, 124.95], pos: 'right' },
            { eng: "Ŭnjin", ll: [36.20, 127.00], pos: 'top' },
            { eng: "Yŏsan", ll: [35.95, 126.95], pos: 'bottom' }
        ];

        function addMarker(p, color) {
            const marker = L.circleMarker(p.ll, {
                radius: p.inland ? 4 : 5,
                color: color,
                weight: 2,
                fillColor: color,
                fillOpacity: 0.9
            }).addTo(map);

            marker.bindTooltip(p.eng, {
                permanent: true,
                direction: p.pos || 'auto',
                className: 'city-label',
                offset: [0, 0]
            }).openTooltip();
        }

        chinese.forEach(p => addMarker(p, "#dc2626"));
        korean.forEach(p => addMarker(p, "#2563eb"));

        const style = (c, dash) => ({ color: c, weight: 3, opacity: 0.7, dashArray: dash || "8 10", lineCap: "round", fill: false });

        function curve(start, cp, end, color, dash) {
            if (typeof L.curve === 'function') {
                L.curve(['M', start, 'Q', cp, end], style(color, dash)).addTo(map);
            } else {
                L.polyline([start, end], style(color, dash)).addTo(map);
            }
        }

        curve([38.80, 121.25], [38.5, 124.0], [39.82, 124.95], "#2563eb");
        curve([37.81, 120.76], [38.8, 123.0], [38.25, 125.10], "#dc2626");
        curve([37.18, 119.94], [38.2, 122.5], [38.25, 125.10], "#dc2626");
        curve([29.86, 121.55], [33.0, 125.5], [36.20, 127.00], "#059669");
        curve([29.86, 121.55], [32.5, 125.8], [35.95, 126.95], "#059669");
        curve([30.50, 114.30], [30.2, 118.00], [29.86, 121.55], "#64748b", "4 8");

        // Landscape bounds - tight N-S, wide E-W for short container
        map.fitBounds([[32, 112], [41, 129]], { padding: [0, 0] });
    </script>
</body>
</html>
